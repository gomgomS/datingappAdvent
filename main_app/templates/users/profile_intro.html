<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favico -->
    <link rel="shortcut icon" href="../../static/assets/img/favicon.png" type="image/x-icon">
    <link rel="icon" href="../../static/assets/img/favicon.png" type="image/x-icon">
    <title>comes.id </title>
    <title></title>
    <!-- vendor css -->
    <link href="../../static/lib/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
    <link href="../../static/lib/ionicons/css/ionicons.min.css" rel="stylesheet">
    <link href="../../static/lib/select2/css/select2.min.css" rel="stylesheet">
    <link href="../../static/lib/flatpicker/flatpickr.min.css" rel="stylesheet">
    <!-- DashForge CSS -->
    <link rel="stylesheet" href="../../static/assets/css/dashforge.css">
    <link rel="stylesheet" href="../../static/css/custom.css">
    <!-- some additional css here -->
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Inter", sans-serif;
      }
      .formbold-main-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 48px;
      }
      
    
      .formbold-form-wrapper {
        margin: 0 auto;
        max-width: 550px;
        width: 100%;
        background: white;
      }
    
      .formbold-container {
      max-width: 600px;
      margin: 50px auto;
      padding: 30px;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  }
  
  .formbold-steps {
      padding-bottom: 20px;
      margin-bottom: 30px;
      border-bottom: 2px solid #DDE3EC;
      text-align: center;
  }
  
  .formbold-steps ul {
      padding: 0;
      margin: 0;
      list-style: none;
      display: flex;
      justify-content: space-between;
      position: relative;
  }
  
  .formbold-steps ul::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 10%;
      width: 80%;
      height: 2px;
      background: #DDE3EC;
      z-index: -1;
  }
  
  .formbold-steps li {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      font-size: 14px;
      color: #536387;
      position: relative;
  }
  
  .formbold-steps li span {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #DDE3EC;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-weight: 600;
      font-size: 10px;
      color: #536387;
      transition: background 0.3s, color 0.3s;
  }
  
  .formbold-steps li.active {
      color: #07074D;
  }
  
  .formbold-steps li.active span {
      background: #F96699;
      color: #FFFFFF;
  }
  
  .formbold-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
  }
  
  .formbold-input-flex {
      display: flex;
      gap: 15px;
  }
  
  .formbold-form-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #DDE3EC;
      border-radius: 6px;
      font-size: 14px;
  }
  
  .formbold-form-btn-wrapper {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
  }
  
  .formbold-btn, .formbold-back-btn {
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
  }
  
  .formbold-btn {
      background: #F96699;
      color: white;
  }
  
  .formbold-btn:hover {
      background: #5148d6;
  }
  
  .formbold-back-btn {
      background: #DDE3EC;
      color: #536387;
  }
  
  .formbold-back-btn:hover {
      background: #c5cad8;
  }
  
    
      .formbold-input-flex {
        display: flex;
        gap: 20px;
        margin-bottom: 22px;
      }
      .formbold-input-flex > div {
        width: 50%;
      }
      .formbold-form-input {
        width: 100%;
        padding: 12px 16px;
        border-radius: 5px;
        border: 1px solid #DDE3EC;
        background: #FFFFFF;
        font-weight: 500;
        font-size: 14px;
        color: #536387;
        outline: none;
        resize: none;
      }
      .formbold-form-input:focus {
        border-color: #F96699;
        box-shadow: 0px 3px 8px rgba(0, 0, 0, 0.05);
      }
  
  /* Desktop date picker styling */
  input[type="date"]::-webkit-calendar-picker-indicator {
    background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTYgMkM1LjQ0NzcyIDIgNSAyLjQ0NzcyIDUgM1YxN0M1IDE3LjU1MjMgNS40NDc3MiAxOCA2IDE4SDE0QzE0LjU1MjMgMTggMTUgMTcuNTUyMyAxNSAxN1YzQzE1IDIuNDQ3NzIgMTQuNTUyMyAyIDE0IDJINlpNNSA2SDE1VjE3SDVWNlpNNyA0VjFIMTNWM1Y0SDdaIiBmaWxsPSIjNjY2NjY2Ii8+Cjwvc3ZnPgo=') no-repeat center;
    background-size: 18px 18px;
    cursor: pointer;
    height: 18px;
    width: 18px;
    opacity: 0.7;
    transition: opacity 0.2s;
  }
  
  input[type="date"]::-webkit-calendar-picker-indicator:hover {
    opacity: 1;
  }
      .formbold-form-label {
        color: #07074D;
        font-weight: 500;
        font-size: 14px;
        line-height: 24px;
        display: block;
        margin-bottom: 10px;
      }
    
      .formbold-form-confirm {
        border-bottom: 1px solid #DDE3EC;
        padding-bottom: 35px;
      }
      .formbold-form-confirm p {
        font-size: 16px;
        line-height: 24px;
        color: #536387;
        margin-bottom: 22px;
        width: 75%;
      }
      .formbold-form-confirm > div {
        display: flex;
        gap: 15px;
      }
    
      .formbold-confirm-btn {
        display: flex;
        align-items: center;
        gap: 10px;
        background: #FFFFFF;
        border: 0.5px solid #DDE3EC;
        border-radius: 5px;
        font-size: 16px;
        line-height: 24px;
        color: #536387;
        cursor: pointer;
        padding: 10px 20px;
        transition: all .3s ease-in-out;
      }
      .formbold-confirm-btn {
        box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.12);
      }
      .formbold-confirm-btn.active {
        background: #F96699;
        color: #FFFFFF;
      }
    
      .formbold-form-step-1,
      .formbold-form-step-2,
      .formbold-form-step-3,
      .formbold-form-step-4,
      .formbold-form-step-5,
      .formbold-form-step-6,
      .formbold-form-step-7 {
        display: none;
      }
      .formbold-form-step-1.active,
      .formbold-form-step-2.active,
      .formbold-form-step-3.active,
      .formbold-form-step-4.active,
      .formbold-form-step-5.active,
      .formbold-form-step-6.active,
      .formbold-form-step-7.active{
        display: block;
      }
    
      .formbold-form-btn-wrapper {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 25px;
        margin-top: 25px;
      }
      .formbold-back-btn {
        cursor: pointer;
        background: #FFFFFF;
        border: none;
        color: #07074D;
        font-weight: 500;
        font-size: 16px;
        line-height: 24px;
        display: none;
      }
      .formbold-back-btn.active {
        display: block;
      }
      .formbold-btn {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 16px;
        border-radius: 5px;
        padding: 10px 25px;
        border: none;
        font-weight: 500;
        background-color: #F96699;
        color: white;
        cursor: pointer;
      }
      .formbold-btn:hover {
        box-shadow: 0px 3px 8px rgba(0, 0, 0, 0.05);
      }

      /* Locked field visuals */
      .locked-field {
        border: 1px solid #dc3545 !important;
        background-color: #fff5f5;
        cursor: not-allowed;
      }
      .locked-note {
        color: #dc3545;
        font-size: 12px;
      }
      .formbold-sex-button.locked {
        border: 1px solid #dc3545 !important;
        background-color: #fff5f5;
        color: #dc3545;
        cursor: not-allowed;
        opacity: 0.95;
      }
  
      .formbold-profile-upload {
      text-align: center;
      margin-bottom: 20px;
      }
  
      .formbold-profile-preview {
          display: flex;
          justify-content: center;
          align-items: center;
          max-width: 100%;
          max-height: 200px; /* Adjust max height to fit the page */
          margin: 0 auto 10px;
      }
  
      .formbold-profile-preview img {
          max-width: 100%;
          max-height: 200px;
          display: none; /* Hide until an image_profile is uploaded */
      }
  
      .profile-label {
          font-weight: bold;
          display: block;
          margin-bottom: 8px;
      }
      
      .formbold-sex-selection {
          display: flex;
          gap: 10px;
      }
  
      .formbold-sex-button {
          padding: 10px 20px;
          border: 1px solid #ccc;
          background-color: #f9f9f9;
          cursor: pointer;
          border-radius: 5px;
      }
  
      .formbold-sex-button.selected {
          background-color: #38CCCC;
          color: white;
          border-color: #38CCCC;
      }
      /* Hobi selection container */
      .formbold-hobi-selection {
          display: flex;
          gap: 20px; /* Space between left and right columns */
          margin-top: 10px;
      }
  
      /* Hobi column styling */
      .formbold-hobi-column {
          display: flex;
          flex-direction: column;
          gap: 10px; /* Space between options */
          width: 50%; /* Each column takes 50% of the container */
      }
  
      /* Hobi option styling */
      .formbold-hobi-option {
          display: flex;
          align-items: center;
          padding: 10px;
          border: 1px solid #ccc;
          border-radius: 5px;
          cursor: pointer;
          transition: background-color 0.3s, border-color 0.3s;
      }
  
      .formbold-hobi-option.selected {
          background-color: #38CCCC;
          border-color: #38CCCC;
          color: white;
      }
  
      .formbold-hobi-option i {
          font-size: 20px;
          margin-right: 10px;
          color: #666;
          transition: color 0.3s;
      }
      
      .formbold-hobi-option.selected i {
          color: white;
      }
  
      .formbold-hobi-option span {
          font-size: 14px;
      }
  
      /* Marital Status Styling */
    .formbold-status-option-maritals {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
  
    .formbold-status-option-marital {
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 5px;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s ease;
    }
  
    .formbold-status-option-marital.selected {
      background-color: #38CCCC;
      color: white;
      border-color: #38CCCC;
    }
  
    /* Textarea Styling */
    .formbold-textarea {
      resize: vertical;
      min-height: 100px;
    }
  
    /* Consistent Input Group Spacing */
    .formbold-input-group {
      margin-top: 20px;
    }
  
    /* Advent Status Styling */
    .formbold-status-option-advents {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
  
    .formbold-status-option-advent {
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 5px;
      cursor: pointer;
      text-align: center;
      transition: all 0.3s ease;
    }
  
    .formbold-status-option-advent.selected {
      background-color: #38CCCC;
      color: white;
      border-color: #38CCCC;
    }

    .formbold-steps ul li {
        font-size: 14px; /* atau 12px sesuai kebutuhan */
        cursor: pointer;
    }

    /* Mobile adjustments: Keep steps in one row with horizontal scroll */
    @media (max-width: 576px) {
      .formbold-steps ul {
        justify-content: flex-start !important;
        gap: 8px;
        flex-wrap: nowrap !important;
        overflow-x: auto;
        overflow-y: hidden;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 8px;
      }
      .formbold-steps ul::before {
        display: none;
      }
      .formbold-steps li {
        flex: 0 0 auto;
      }
      .formbold-steps li span { width: 28px; height: 28px; font-size: 10px; }
      .formbold-form-input { 
        padding: 12px 14px; 
        font-size: 16px; /* Prevent zoom on iOS */
        min-height: 44px; /* Ensure touch target is large enough */
      }
      
      /* Specific fixes for date input on mobile */
      input[type="date"] {
        padding: 12px 14px !important;
        font-size: 16px !important;
        min-height: 44px !important;
        -webkit-appearance: none;
        appearance: none;
        background-color: #FFFFFF;
        position: relative;
      }
      
      /* Fix for mobile date picker - make calendar icon visible and clickable */
      input[type="date"]::-webkit-calendar-picker-indicator {
        background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTYgMkM1LjQ0NzcyIDIgNSAyLjQ0NzcyIDUgM1YxN0M1IDE3LjU1MjMgNS40NDc3MiAxOCA2IDE4SDE0QzE0LjU1MjMgMTggMTUgMTcuNTUyMyAxNSAxN1YzQzE1IDIuNDQ3NzIgMTQuNTUyMyAyIDE0IDJINlpNNSA2SDE1VjE3SDVWNlpNNyA0VjFIMTNWM1Y0SDdaIiBmaWxsPSIjNjY2NjY2Ii8+Cjwvc3ZnPgo=') no-repeat center;
        background-size: 20px 20px;
        cursor: pointer;
        height: 20px;
        width: 20px;
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        opacity: 0.7;
      }
      
      input[type="date"]::-webkit-calendar-picker-indicator:hover {
        opacity: 1;
      }
      
      .formbold-btn, .formbold-back-btn { padding: 12px 16px; font-size: 16px; min-height: 44px; }
      .formbold-sex-selection { gap: 8px; }
      .formbold-sex-button { padding: 12px 14px; font-size: 14px; flex: 1; min-height: 44px; }
      .formbold-hobi-option { padding: 10px; min-height: 44px; }
      .formbold-hobi-option i { font-size: 18px; }
      .formbold-status-option-maritals { gap: 8px; }
      .formbold-status-option-marital { padding: 12px; font-size: 14px; min-height: 44px; }
      .formbold-status-option-advents { gap: 8px; }
      .formbold-status-option-advent { padding: 12px; font-size: 14px; min-height: 44px; }
    }

    </style>
</head>

{% autoescape false %}
<body>

<div class="formbold-main-wrapper">
    <!-- Author: FormBold Team -->
    <!-- Learn More: https://formbold.com -->
    <div class="formbold-form-wrapper">      
      <form action="/update/profile" method="POST" enctype="multipart/form-data">
        <input name="_csrf_token" type="hidden" value="{{ csrf_token() }}">  
        <input name="user_id" type="hidden" value="{{ data_user.user_id }}">  
        <div class="formbold-steps">
          <ul style="display: flex; flex-wrap: wrap; gap: 8px; padding: 0; margin: 0; list-style: none; justify-content: center;">
            <li class="formbold-step-menu1 active" style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: #536387;">
              <span style="display: flex; align-items: center; justify-content: center; background: #DDE3EC; border-radius: 50%; width: 24px; height: 24px; font-size: 10px; font-weight: 600; color: #536387;">1</span> Profil
            </li>
            <li class="formbold-step-menu2" style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: #536387;">
              <span style="display: flex; align-items: center; justify-content: center; background: #DDE3EC; border-radius: 50%; width: 24px; height: 24px; font-size: 10px; font-weight: 600; color: #536387;">2</span> Gender
            </li>
            <li class="formbold-step-menu3" style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: #536387;">
              <span style="display: flex; align-items: center; justify-content: center; background: #DDE3EC; border-radius: 50%; width: 24px; height: 24px; font-size: 10px; font-weight: 600; color: #536387;">3</span> Hobi
            </li>
            <li class="formbold-step-menu4" style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: #536387;">
              <span style="display: flex; align-items: center; justify-content: center; background: #DDE3EC; border-radius: 50%; width: 24px; height: 24px; font-size: 10px; font-weight: 600; color: #536387;">4</span> Asal
            </li>
            <li class="formbold-step-menu5" style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: #536387;">
              <span style="display: flex; align-items: center; justify-content: center; background: #DDE3EC; border-radius: 50%; width: 24px; height: 24px; font-size: 10px; font-weight: 600; color: #536387;">5</span> Status
            </li>
            <li class="formbold-step-menu6" style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: #536387;">
              <span style="display: flex; align-items: center; justify-content: center; background: #DDE3EC; border-radius: 50%; width: 24px; height: 24px; font-size: 10px; font-weight: 600; color: #536387;">6</span> Advent
            </li>
            <li class="formbold-step-menu7" style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: #536387;">
              <span style="display: flex; align-items: center; justify-content: center; background: #DDE3EC; border-radius: 50%; width: 24px; height: 24px; font-size: 10px; font-weight: 600; color: #536387;">7</span> Kirim
            </li>
          </ul>
        </div>
        
      
    
        <div class="formbold-form-step-1 active">
          <!-- Step 1: Sign Up Fields -->
      
          <div class="formbold-profile-upload">
              <div id="profilePreviewWrapper" class="formbold-profile-preview">
                  <img id="profilePreview" src="{{ data_user['profile_photo'] }}" alt="Profile Picture Preview" {% if data_user['profile_photo'] %}style="display:block"{% endif %} />
              </div>
               <label for="profilePicture" class="formbold-form-label profile-label"> Upload Profile Picture {% if not data_user['profile_photo'] %}<span style="color: red;">*</span>{% endif %} </label>              
            <input
                  type="file"
                  name="image_profile"
                  id="profilePicture"
                accept="image/*"
                  class="formbold-form-input"
                  value="{{data_user['profile_photo']}}"
                  {% if not data_user['profile_photo'] %}required{% endif %}
              />
               {% if data_user['profile_photo'] %}
               <small style="color: #28a745; font-size: 12px; display: block; margin-top: 5px;">‚úì Profile picture already uploaded</small>
               {% else %}
               <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">Required: Please upload your profile picture</small>
               {% endif %}
          </div>
          <div class="formbold-input-flex mb-0">
            <div>
                <label for="username" class="formbold-form-label"> username </label>
                <input
                    type="text"
                    name="username"
                    id="username"
                    value="{{data_user['username']}}"
                    class="formbold-form-input locked-field"
                    disabled
                />
                <input type="hidden" name="username" value="{{data_user['username']}}" />
            </div>
            <div>
                <label for="email" class="formbold-form-label"> Email </label>
                <input
                    type="text"
                    name="email"
                    id="email"                    
                    value="{{data_user['email']}}"
                    class="formbold-form-input {% if data_user.verify_email == 'TRUE' %}locked-field{% endif %}"
                    {% if data_user.verify_email == 'TRUE' %}disabled{% endif %}
                />
                {% if data_user.verify_email == 'TRUE' %}
                <div class="valid-feedback" style="color:green;">
                  Your email has been verified. To change it, please contact administration.
                </div>
                {% endif %}
            </div>
        </div>
        <div class="mb-3">
            <small class="locked-note">This field is locked. To change it, please contact administration.</small>
        </div>
          <div class="formbold-input-flex">
              <div>
                  <label for="name" class="formbold-form-label"> Name <span style="color: red;">*</span> </label>
                  <input
                      type="text"
                      name="name"
                      id="name"
                      placeholder="{{data_user.name}}"
                      class="formbold-form-input"
                      value="{{data_user.name}}"
                      required
                  />
              </div>
              <div>
                   <label for="phone" class="formbold-form-label"> Phone Number <span style="color: red;">*</span> </label>
                  <input
                      type="tel"
                      name="phone"
                      id="phone"
                       placeholder="08xxxxxxxxxx (9-12 digits)"
                      class="formbold-form-input"
                      value="{{data_user.phone}}"
                       pattern="[0-9]{9,12}"
                       title="Phone number must be 9-12 digits"
                       required
                   />
              </div>
          </div>
      
          <div>
              <label for="dob" class="formbold-form-label"> Date of Birth <span style="color: red;">*</span> </label>
              <input
                  type="date"
                  name="dob"
                  id="dob"
                  class="formbold-form-input"
                  value="{{data_user.dob if data_user.dob else ''}}"
                  max=""
                  required
                  style="position: relative;"
              />
              <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">You must be at least 18 years old to use this service</small>
          </div>
        </div>
      
    
        <div class="formbold-form-step-2">
            <!-- Step 2: Sex Fields -->            
            <label class="formbold-form-label">Sex <span style="color: red;">*</span></label>
            {% if not data_user.sex %}
            <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 10px; margin-bottom: 15px;">
                <strong style="color: #856404;">‚ö†Ô∏è Important:</strong> <span style="color: #856404;">Sex can only be chosen once and cannot be changed later. Please choose carefully!</span>
            </div>
            {% endif %}
            <div class="formbold-sex-selection">
                <button type="button" class="formbold-sex-button {% if data_user.sex %}locked{% endif %}" data-value="male" onclick="selectSex('male')" {% if data_user.sex %}disabled{% endif %}>Male</button>
                <button type="button" class="formbold-sex-button {% if data_user.sex %}locked{% endif %}" data-value="female" onclick="selectSex('female')" {% if data_user.sex %}disabled{% endif %}>Female</button>
            </div>
            <input type="hidden" name="sex" id="sex" value="{{ data_user.sex }}" {% if not data_user.sex %}required{% endif %} />
            <div style="text-align: right; margin-top: 5px;">
                <small style="color: #888; font-size: 12px;">Jenis Kelamin</small>
            </div>
            {% if data_user.sex %}
            <small class="locked-note">This field is locked. To change it, please contact administration.</small>
            {% endif %}            
        </div>
    
        <!-- Step 3: Hobi Fields -->
        <div class="formbold-form-step-3">
          <label class="formbold-form-label">Select Your Hobbies {{ data_user.hobbies }}</label>
          <div class="formbold-hobi-selection">
              <!-- Left Column -->
              <div class="formbold-hobi-column">
                  <div class="formbold-hobi-option" data-value="photography" onclick="toggleHobi('photography')">
                       <i class="fas fa-camera" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Photography</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="karaoke" onclick="toggleHobi('karaoke')">
                       <i class="fas fa-microphone" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Karaoke</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="cooking" onclick="toggleHobi('cooking')">
                       <i class="fas fa-utensils" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Cooking</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="running" onclick="toggleHobi('running')">
                       <i class="fas fa-running" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Running</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="art" onclick="toggleHobi('art')">
                       <i class="fas fa-palette" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Art</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="extreme" onclick="toggleHobi('extreme')">
                       <i class="fas fa-mountain" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Extreme Sports</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="read-bible" onclick="toggleHobi('read-bible')">
                       <i class="fas fa-book" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Read Bible</span>
                  </div>
              </div>

              <!-- Right Column -->
              <div class="formbold-hobi-column">
                  <div class="formbold-hobi-option" data-value="shopping" onclick="toggleHobi('shopping')">
                      <i class="fas fa-shopping-bag" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Shopping</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="tennis" onclick="toggleHobi('tennis')">
                      <i class="fas fa-table-tennis" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Tennis</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="yoga" onclick="toggleHobi('yoga')">
                      <i class="fas fa-leaf" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Yoga</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="swimming" onclick="toggleHobi('swimming')">
                      <i class="fas fa-swimmer" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Swimming</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="traveling" onclick="toggleHobi('traveling')">
                      <i class="fas fa-plane" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Traveling</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="music" onclick="toggleHobi('music')">
                      <i class="fas fa-music" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Music</span>
                  </div>
                  <div class="formbold-hobi-option" data-value="video-games" onclick="toggleHobi('video-games')">
                      <i class="fas fa-gamepad" style="font-size: 20px; margin-right: 10px; color: #666;"></i>
                      <span>Video Games</span>
                  </div>
              </div>
          </div>
          <input type="hidden" name="hobbies" id="hobbies" value="{{ data_user['hobbies'] }}" />
        </div>
        
        <!-- Step 4: Additional Details -->
        <div class="formbold-form-step-4">       
            <div class="formbold-additional-selection">
              <div class="formbold-input-group" style="position: relative;">
                <label for="city" class="formbold-form-label">Hometown</label>
                <input 
                  type="text" 
                  name="city" 
                  id="city" 
                  class="formbold-form-input" 
                  placeholder="Enter your city" 
                  value="{{ data_user.city }}" 
                  onfocus="showTopCities()" 
                  oninput="filterCities(this.value)"
                  autocomplete="off"
                />
                <ul id="city-suggestions" style="position:absolute; background:#fff; border:1px solid #ccc; z-index:999; list-style:none; padding:0; margin:0; width:100%; display:none;"></ul>
                <div style="text-align: right; margin-top: 5px;">
                  <small style="color: #888; font-size: 12px;">Kota Asal</small>
                </div>
              </div>
            
              <div class="formbold-input-group" style="position: relative;">
                <label for="tribe" class="formbold-form-label">Tribe</label>
                <input 
                  type="text" 
                  name="tribe" 
                  id="tribe" 
                  class="formbold-form-input" 
                  placeholder="Enter your tribe" 
                  value="{{ data_user.tribe }}" 
                  onfocus="showTopTribes()" 
                  oninput="filterTribes(this.value)"
                  autocomplete="off"
                />
                <span 
                  onclick="document.getElementById('tribe-info-modal').style.display='block'"
                  style="position:absolute; right:10px; top:50%; transform:translateY(-50%); cursor:pointer;"
                  title="Info"
                >
                  üëÅÔ∏è
                </span>    
                <ul id="tribe-suggestions" style="position:absolute; background:#fff; border:1px solid #ccc; z-index:999; list-style:none; padding:0; margin:0; width:100%; display:none;"></ul>
                <div style="text-align: right; margin-top: 5px;">
                  <small style="color: #888; font-size: 12px;">Suku</small>
                </div>
              </div>

              <!-- Modal Info -->
              <div id="tribe-info-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:1000;">
                <div style="background:#fff; padding:20px; max-width:500px; margin:100px auto; border-radius:8px; position:relative;">
                  <h3>Informasi Pengisian Suku</h3>
                  <p style="margin-bottom:1em;">
                    Mohon maaf sebelumnya, kami tidak bermaksud membedakan siapa pun. Fitur ini disediakan karena beberapa teman kita berharap bisa menemukan komunitas atau pasangan yang berasal dari suku yang sama.
                  </p>
                  <p>
                    Silakan isi jika berkenan, dan boleh dikosongkan jika tidak ingin mencantumkan informasi ini.
                  </p>
                  <button onclick="document.getElementById('tribe-info-modal').style.display='none'" style="margin-top:1em; padding:8px 16px; border:none; background:#333; color:#fff; border-radius:4px;">Tutup</button>
                </div>
              </div>
            
              <div class="formbold-input-group">
                <label for="congregation" class="formbold-form-label">Registered Congregation</label>
                <input type="text" name="congregation" id="congregation" class="formbold-form-input" placeholder="Enter your registered congregation" value="{{ data_user.congregation }}"/>
                <div style="text-align: right; margin-top: 5px;">
                  <small style="color: #888; font-size: 12px;">Terdaftar Jemaat</small>
                </div>
              </div>            
            </div>       
        </div>
    
        <!-- Step 5: married Details -->
        <div class="formbold-form-step-5">
          <!-- Marital Status Selection -->
          <div class="formbold-marital-selection">
            <label class="formbold-form-label">Marital Status</label>
            <div class="formbold-status-option-maritals">
              <div 
                class="formbold-status-option-marital" 
                data-value="never-married" 
                onclick="selectMaritalStatus('never-married')"
              >
                Single - Never Married
              </div>
              <div 
                class="formbold-status-option-marital" 
                data-value="abandoned" 
                onclick="selectMaritalStatus('abandoned')"
              >
                Single - Abandoned
              </div>
              <div 
                class="formbold-status-option-marital" 
                data-value="separated" 
                onclick="selectMaritalStatus('separated')"
              >
                Single - Separated
              </div>
              <div 
                class="formbold-status-option-marital" 
                data-value="divorced" 
                onclick="selectMaritalStatus('divorced')"
              >
                Single - Divorced
              </div>
              <div 
                class="formbold-status-option-marital" 
                data-value="widowed" 
                onclick="selectMaritalStatus('widowed')"
              >
                Single - Widower/Widow
              </div>
              <div 
                class="formbold-status-option-marital" 
                data-value="complicated" 
                onclick="selectMaritalStatus('complicated')"
              >
                Complicated
              </div>
              <div 
                class="formbold-status-option-marital" 
                data-value="other" 
                onclick="selectMaritalStatus('other')"
              >
                Other
              </div>
            </div>
            <input type="hidden" name="marital_status" id="marital_status" value="{{ data_user['marital_status'] }}">
            <div style="text-align: right; margin-top: 5px;">
              <small style="color: #888; font-size: 12px;">Status Saat Ini</small>
            </div>
          </div>

          <!-- Job Input -->
          <div class="formbold-input-group">
            <label for="job" class="formbold-form-label">Job/Profession</label>
            <input 
              type="text" 
              name="job" 
              id="job" 
              class="formbold-form-input" 
              placeholder="Enter your job/profession"
              value="{{data_user.job}}"
            >
          </div>

          <!-- About Textarea -->
          <div class="formbold-input-group">
            <label for="about" class="formbold-form-label">About Yourself</label>
            <textarea 
              name="about" 
              id="about" 
              class="formbold-form-input formbold-textarea" 
              placeholder="Tell us about yourself..."
              rows="4"              
            >{{ data_user.about }}</textarea>
          </div>
        </div>
    
        <div class="formbold-form-step-6">
            <!-- Step 6: Review -->
            <!-- Advenr Status Selection -->
          <div class="formbold-advent-selection">
            <label class="formbold-form-label">Advent Status</label>
            <div class="formbold-status-option-advents">
              <div 
                class="formbold-status-option-advent" 
                data-value="not_advent" 
                onclick="selectAdventStatus('not_advent')"
              >
                Bukan Seorang Advent
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="progresif" 
                onclick="selectAdventStatus('progresif')"
              >
                Advent Progresif
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="still-learn" 
                onclick="selectAdventStatus('still-learn')"
              >
                Masih Belajar Ajaran Advent (belum)
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="since-birth" 
                onclick="selectAdventStatus('since-birth')"
              >
                Sejak Lahir Advent
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="conservative" 
                onclick="selectAdventStatus('conservative')"
              >
                Advent konservatif
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="liberal" 
                onclick="selectAdventStatus('liberal')"
              >
                Advent Liberal
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="new-member" 
                onclick="selectAdventStatus('new-member')"
              >
                Baru Menjadi Advent
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="Moderat" 
                onclick="selectAdventStatus('Moderat')"
              >
                Advent Moderat
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="try-return" 
                onclick="selectAdventStatus('try-return')"
              >
                Berusaha Kembali Advent
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="re-baptized" 
                onclick="selectAdventStatus('re-baptized')"
              >
                Advent Dibabtis Ulang
              </div>
              <div 
                class="formbold-status-option-advent" 
                data-value="Davidian" 
                onclick="selectAdventStatus('Davidian')"
              >
                Davidian
              </div>              
              <div 
                class="formbold-status-option-advent" 
                data-value="other" 
                onclick="selectAdventStatus('other')"
              >
                Other
              </div>
            </div>
            <input type="hidden" name="advent_status" id="advent_status" value="{{ data_user['advent_status'] }}">
          </div>
        </div>
    
        <div class="formbold-form-step-7">                  
          
          <div class="form-group row">
            <div class="alert alert-warning alert-dismissible fade" role="alert">
                <strong>Files is too large</strong> Image more than 1 MB.
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
            </div>              
              <div class="col-sm-7">   
                  <input type="hidden" name="img_removed" id="img_removed">
                  <div class="image-gallery">
                      {% for image in data_user.image %}                                        
                          <div class="image-area"><img src="{{image_base_url}}{{ image }}" style="width: 100px;height: 100px;margin:5px;"><a class="remove-image" data-values="{{ image }}" style="display: inline; color:red;">&#215;</a></div>                                                                                                      
                      {%endfor%}
                  </div>
                <input type="file" id="filePic" class="d-none" name="image[]" multiple="">                             
                  <label id="filePicButton" for="filePic" class="d-flex Cur(p) mg-t-10">
                      <i class="rounded-left bg-dark text-white pd-10 fas fa-cloud-upload-alt cbs-1"></i>
                      <span class="bg-success pd-7 cbs-1 text-white rounded-right">Upload Your Gallery</span> <span class="ml-3 mt-2" style="color: red;"> *ukuran maksimal file 1MB</span>
                  </label>
              </div>
          </div> 
        
          <label class="formbold-form-label">Jangan Kuatir, Anda bisa melakukan perubahan nanti, pada menu profile anda</label>
            <!-- Step 7: Submit -->
        </div>
    
        <div class="formbold-form-btn-wrapper">
            <button class="formbold-back-btn">Back</button>
        
            {% if data_user['profile_intro'] == 'TRUE' %}
                <a href="/swipe">Cancel</a>
            {% endif %}
        
            <button class="formbold-btn">Next Step</button>
        </div>
    </form>
    
    </div>
  </div>

  <script src="../../static/lib/jquery/jquery.min.js"></script>
  <script src="../../static/lib/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../../static/lib/feather-icons/feather.min.js"></script>
  <script src="../../static/lib/perfect-scrollbar/perfect-scrollbar.min.js"></script>
  <script src="../../static/lib/select2/js/select2.min.js"></script>
  <script src="../../static/lib/flatpicker/flatpickr.js"></script>
  <script src="../../static/assets/js/dashforge.js"></script>
  <script src="../../static/assets/js/dashforge.aside.js"></script>
  <script src="../../static/js/pytavia-js/custom/ckeditor/ckeditor.js"></script>

  <script>
    const stepMenuOne = document.querySelector('.formbold-step-menu1');
    const stepMenuTwo = document.querySelector('.formbold-step-menu2');
    const stepMenuThree = document.querySelector('.formbold-step-menu3');
    const stepMenuFour = document.querySelector('.formbold-step-menu4');
    const stepMenuFive = document.querySelector('.formbold-step-menu5');
    const stepMenuSix = document.querySelector('.formbold-step-menu6');
    const stepMenuSeven = document.querySelector('.formbold-step-menu7');

    const stepOne = document.querySelector('.formbold-form-step-1');
    const stepTwo = document.querySelector('.formbold-form-step-2');
    const stepThree = document.querySelector('.formbold-form-step-3');
    const stepFour = document.querySelector('.formbold-form-step-4');
    const stepFive = document.querySelector('.formbold-form-step-5');
    const stepSix = document.querySelector('.formbold-form-step-6');
    const stepSeven = document.querySelector('.formbold-form-step-7');

    const formSubmitBtn = document.querySelector('.formbold-btn');
    const formBackBtn = document.querySelector('.formbold-back-btn');

    formSubmitBtn.addEventListener("click", function(event){
        event.preventDefault();
        if(stepMenuOne.classList.contains('active')) {
            // Validate Step 1: Profile Picture, Name, Phone, and Age
            const profilePicture = document.getElementById('profilePicture');
            const nameInput = document.getElementById('name');
            const phoneInput = document.getElementById('phone');
            const dobInput = document.getElementById('dob');
            
            // Check if profile picture is uploaded or already exists
            const hasExistingPhoto = "{{ data_user['profile_photo'] }}" && "{{ data_user['profile_photo'] }}".trim() !== "";
            const hasNewPhoto = profilePicture.files && profilePicture.files.length > 0;
            
            if (!hasExistingPhoto && !hasNewPhoto) {
                alert('Please upload a profile picture before proceeding.');
                return;
            }
            
            // Check if name is filled
            if (!nameInput.value.trim()) {
                alert('Please enter your name before proceeding.');
                nameInput.focus();
                return;
            }
            
            // Check if phone is filled and valid
            if (!phoneInput.value.trim()) {
                alert('Please enter your phone number before proceeding.');
                phoneInput.focus();
                return;
            }
            
            // Validate phone number format (9-12 digits)
            const phoneRegex = /^[0-9]{9,12}$/;
            if (!phoneRegex.test(phoneInput.value)) {
                alert('Please enter a valid phone number (9-12 digits).');
                phoneInput.focus();
                return;
            }
            
            // Check if date of birth is filled
            if (!dobInput.value) {
                alert('Please enter your date of birth before proceeding.');
                dobInput.focus();
                return;
            }
            
            // Validate age (must be at least 18 years old)
            const selectedDate = new Date(dobInput.value);
            const today = new Date();
            const age = today.getFullYear() - selectedDate.getFullYear();
            const monthDiff = today.getMonth() - selectedDate.getMonth();
            
            // Adjust age if birthday hasn't occurred this year
            const actualAge = (monthDiff < 0 || (monthDiff === 0 && today.getDate() < selectedDate.getDate())) ? age - 1 : age;
            
            if (actualAge < 18) {
                alert('You must be at least 18 years old to use this service.');
                dobInput.focus();
                return;
            }
            
            // All validations passed, proceed to step 2
            stepMenuOne.classList.remove('active');
            stepMenuTwo.classList.add('active');
            stepOne.classList.remove('active');
            stepTwo.classList.add('active');
            formBackBtn.classList.add('active');
        } else if(stepMenuTwo.classList.contains('active')) {
            // Validate sex selection
            const sexValue = document.getElementById('sex').value;
            if (!sexValue) {
                alert('Please select your sex before proceeding.');
                return;
            }
            stepMenuTwo.classList.remove('active');
            stepMenuThree.classList.add('active');
            stepTwo.classList.remove('active');
            stepThree.classList.add('active');
        } else if(stepMenuThree.classList.contains('active')) {
            stepMenuThree.classList.remove('active');
            stepMenuFour.classList.add('active');
            stepThree.classList.remove('active');
            stepFour.classList.add('active');
        } else if(stepMenuFour.classList.contains('active')) {
            stepMenuFour.classList.remove('active');
            stepMenuFive.classList.add('active');
            stepFour.classList.remove('active');
            stepFive.classList.add('active');
        } else if(stepMenuFive.classList.contains('active')) {
            stepMenuFive.classList.remove('active');
            stepMenuSix.classList.add('active');
            stepFive.classList.remove('active');
            stepSix.classList.add('active');
        } else if(stepMenuSix.classList.contains('active')) {
            stepMenuSix.classList.remove('active');
            stepMenuSeven.classList.add('active');
            stepSix.classList.remove('active');
            stepSeven.classList.add('active');
            formSubmitBtn.textContent = 'Submit';
        } else if(stepMenuSeven.classList.contains('active')) {
            document.querySelector('form').submit();
        }
    });

    formBackBtn.addEventListener("click", function(event){
        event.preventDefault();
        if(stepMenuSeven.classList.contains('active')) {
            stepMenuSeven.classList.remove('active');
            stepMenuSix.classList.add('active');
            stepSeven.classList.remove('active');
            stepSix.classList.add('active');
            formSubmitBtn.textContent = 'Next Step';
        } else if(stepMenuSix.classList.contains('active')) {
            stepMenuSix.classList.remove('active');
            stepMenuFive.classList.add('active');
            stepSix.classList.remove('active');
            stepFive.classList.add('active');
        } else if(stepMenuFive.classList.contains('active')) {
            stepMenuFive.classList.remove('active');
            stepMenuFour.classList.add('active');
            stepFive.classList.remove('active');
            stepFour.classList.add('active');
        } else if(stepMenuFour.classList.contains('active')) {
            stepMenuFour.classList.remove('active');
            stepMenuThree.classList.add('active');
            stepFour.classList.remove('active');
            stepThree.classList.add('active');
        } else if(stepMenuThree.classList.contains('active')) {
            stepMenuThree.classList.remove('active');
            stepMenuTwo.classList.add('active');
            stepThree.classList.remove('active');
            stepTwo.classList.add('active');
        } else if(stepMenuTwo.classList.contains('active')) {
            stepMenuTwo.classList.remove('active');
            stepMenuOne.classList.add('active');
            stepTwo.classList.remove('active');
            stepOne.classList.add('active');
            formBackBtn.classList.remove('active');
        }
    });

    const profilePictureInput = document.getElementById('profilePicture');
    const profilePreview = document.getElementById('profilePreview');

    profilePictureInput.addEventListener('change', function () {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                profilePreview.src = e.target.result;
                profilePreview.style.display = 'block'; // Show image_profile preview
            };
            reader.readAsDataURL(file);
        }
    });
    //EDIT SECTION
    // ================ start SEX
    document.addEventListener("DOMContentLoaded", function() {
        const currentSexValue = (document.getElementById('sex')?.value || '').trim();
        if (currentSexValue) {
            selectSex(currentSexValue);
        }
    });
   
    function selectSex(sex) {
        // Set the value of the hidden input
        document.getElementById('sex').value = sex;

        // Optionally, add visual feedback for the selected button
        const buttons = document.querySelectorAll('.formbold-sex-button');
        buttons.forEach(button => {
            if (button.getAttribute('data-value') === sex) {
                button.classList.add('selected');
            } else {
                button.classList.remove('selected');
            }
        });
    }
    // end ================== 

    // Array to store selected hobbies
    //=========== Initialize selected hobbies from backend
    let selectedHobbies = (document.getElementById('hobbies')?.value || '')
      .split(',')
      .map(h => h.trim())
      .filter(h => h !== "");

    function toggleHobi(hobi) {
        const hobiOption = document.querySelector(`.formbold-hobi-option[data-value="${hobi}"]`);
        const index = selectedHobbies.indexOf(hobi);

        // Toggle selection
        if (index === -1) {
            selectedHobbies.push(hobi); // Add to selected hobbies
            hobiOption.classList.add('selected'); // Add visual feedback
        } else {
            selectedHobbies.splice(index, 1); // Remove from selected hobbies
            hobiOption.classList.remove('selected'); // Remove visual feedback
        }

        // Update the hidden input value
        document.getElementById('hobbies').value = selectedHobbies.join(',');
    }

    // Preselect hobbies on page load
    document.addEventListener("DOMContentLoaded", function () {
        selectedHobbies.forEach(hobi => {
            const hobiOption = document.querySelector(`.formbold-hobi-option[data-value="${hobi}"]`);
            if (hobiOption) {
                hobiOption.classList.add('selected');
            }
        });
    });
    // end ================== 

    // =============== Initialize selected marital status from backend  
    let selectedMaritalStatus = (document.getElementById('marital_status')?.value || '').trim();

    function selectMaritalStatus(status) {
        const options = document.querySelectorAll('.formbold-status-option-marital');
        
        // Remove selection from all options
        options.forEach(option => {
            option.classList.remove('selected');
        });

        if (selectedMaritalStatus !== status) {
            selectedMaritalStatus = status; // Set new selection
            const selectedOption = document.querySelector(`.formbold-status-option-marital[data-value="${status}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected'); // Add visual feedback
            }
        } else {
            selectedMaritalStatus = ""; // Deselect if clicked again
        }
        
        // Update the hidden input value
        document.getElementById('marital_status').value = selectedMaritalStatus;
    }

    // Preselect marital status on page load
    document.addEventListener("DOMContentLoaded", function () {
        if (selectedMaritalStatus) {
            const selectedOption = document.querySelector(`.formbold-status-option-marital[data-value="${selectedMaritalStatus}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
        }
    });


    // end ================== 
    // ================== Initialize selected advent status from backend
    let selectedAdventStatus = (document.getElementById('advent_status')?.value || '').trim();

    function selectAdventStatus(status) {
        const options = document.querySelectorAll('.formbold-status-option-advent');
        
        // Remove selection from all options
        options.forEach(option => {
            option.classList.remove('selected');
        });

        if (selectedAdventStatus !== status) {
            selectedAdventStatus = status; // Set new selection
            const selectedOption = document.querySelector(`.formbold-status-option-advent[data-value="${status}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected'); // Add visual feedback
            }
        } else {
            selectedAdventStatus = ""; // Deselect if clicked again
        }
        
        // Update the hidden input value
        document.getElementById('advent_status').value = selectedAdventStatus;
    }

    // Preselect advent status on page load
    document.addEventListener("DOMContentLoaded", function () {
        if (selectedAdventStatus) {
            const selectedOption = document.querySelector(`.formbold-status-option-advent[data-value="${selectedAdventStatus}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
        }
    });

    // end ================== 


    //upload image_profile
    const file = document.getElementById('profilePicture');     

    file.addEventListener('change', function(){
      const file = this.files[0];            
      if (file && file.type.startsWith('image_profile/')) {
          const reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onload = () => {
          upContainer.src = reader.result;             
          };
      };
    })

    // Ensure preview is visible if an initial image exists
    document.addEventListener('DOMContentLoaded', function() {
      if (profilePreview && profilePreview.getAttribute('src')) {
        profilePreview.style.display = 'block';
      }
    });

    // Phone number validation with real-time feedback
    document.addEventListener('DOMContentLoaded', function() {
      const phoneInput = document.getElementById('phone');
      if (phoneInput) {
        phoneInput.addEventListener('input', function() {
          const value = this.value;
          const phoneRegex = /^[0-9]{9,12}$/;
          
          // Remove any non-numeric characters
          const numericValue = value.replace(/[^0-9]/g, '');
          this.value = numericValue;
          
          // Add visual feedback
          if (numericValue.length > 0) {
            if (phoneRegex.test(numericValue)) {
              this.style.borderColor = '#28a745';
              this.style.backgroundColor = '#f8fff9';
            } else if (numericValue.length < 9) {
              this.style.borderColor = '#ffc107';
              this.style.backgroundColor = '#fffdf7';
            } else {
              this.style.borderColor = '#dc3545';
              this.style.backgroundColor = '#fff5f5';
            }
          } else {
            this.style.borderColor = '#DDE3EC';
            this.style.backgroundColor = '#FFFFFF';
          }
        });
        
        phoneInput.addEventListener('blur', function() {
          // Reset styling on blur if empty
          if (!this.value) {
            this.style.borderColor = '#DDE3EC';
            this.style.backgroundColor = '#FFFFFF';
          }
        });
      }
    });

    // Age validation - set maximum date (18 years ago) and validate age
    document.addEventListener('DOMContentLoaded', function() {
      const dobInput = document.getElementById('dob');
      if (dobInput) {
        // Calculate date 18 years ago from today
        const today = new Date();
        const eighteenYearsAgo = new Date(today.getFullYear() - 18, today.getMonth(), today.getDate());
        const maxDate = eighteenYearsAgo.toISOString().split('T')[0];
        
        // Set maximum date to prevent selection of dates that would make user under 18
        dobInput.setAttribute('max', maxDate);
        
        // Mobile-specific improvements
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        if (isMobile) {
          // Set font size to prevent zoom on iOS
          dobInput.style.fontSize = '16px';
          
          // Add click handler for better mobile experience
          dobInput.addEventListener('click', function() {
            // Ensure the input is focused and ready for date picker
            this.focus();
            // Force show date picker on mobile (with fallback)
            if (this.showPicker) {
              this.showPicker();
            } else {
              // Fallback: trigger focus and blur to reset, then focus again
              this.blur();
              setTimeout(() => this.focus(), 100);
            }
          });
          
          // Add touch event for better mobile interaction
          dobInput.addEventListener('touchstart', function() {
            this.focus();
          });
        } else {
          // Desktop: Add click handler for calendar icon
          dobInput.addEventListener('click', function() {
            this.focus();
          });
        }
        
        // Add real-time validation feedback
        dobInput.addEventListener('change', function() {
          const selectedDate = new Date(this.value);
          const today = new Date();
          const age = today.getFullYear() - selectedDate.getFullYear();
          const monthDiff = today.getMonth() - selectedDate.getMonth();
          
          // Adjust age if birthday hasn't occurred this year
          const actualAge = (monthDiff < 0 || (monthDiff === 0 && today.getDate() < selectedDate.getDate())) ? age - 1 : age;
          
          if (this.value) {
            if (actualAge >= 18) {
              this.style.borderColor = '#28a745';
              this.style.backgroundColor = '#f8fff9';
            } else {
              this.style.borderColor = '#dc3545';
              this.style.backgroundColor = '#fff5f5';
            }
          } else {
            this.style.borderColor = '#DDE3EC';
            this.style.backgroundColor = '#FFFFFF';
          }
        });
        
        // Add input event for better mobile compatibility
        dobInput.addEventListener('input', function() {
          // Trigger change event for validation
          this.dispatchEvent(new Event('change'));
        });
        
        // Initial validation if there's already a value
        if (dobInput.value) {
          dobInput.dispatchEvent(new Event('change'));
        }
      }
    });

        $( document ).ready(function() {
            var removed_img_list = [];
            var temp_files = [];
            var old_pic = [];

            const lists = [
                {
                    id: 'kategori',
                    placeholder: '- Kategori -'
                }
            ];


            lists.forEach(list => {
                $(`#${list.id}`).select2({
                    width: '100%',
                    placeholder: list.placeholder
                })
                $(`#${list.id}`).one('select2:open', function (e) {
                    $('input.select2-search__field').prop('placeholder', 'Search');
                });
            });

            const file = document.getElementById('filePic');
            const upContainer = document.querySelector('.upload-photo');    

            file.addEventListener('change', function(){
            const file = this.files[0];            
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => {
                upContainer.src = reader.result;             
                };
            };
            })
        
            //view img
            // $(function() {
            // $('.upload-photo').on('click', function() {        
            //     $('.imagepreview').attr('src', $(this).attr('src'));
            //     $('#imagemodal').modal('show');   
            // });		
            // });

            //view img
            $(function() {
                //multiple image prview code
                var imagepreview = function(input,placeToInsertImagePreview){                    

                                        
                    if(input.files){
                        var filesAmount = input.files.length;

                        for (i=0; i<filesAmount; i++){

                            var f = event.target.files[i]

                            if(f.size > 1000000){
                                // alert('data more than 1 MB');                                
                                $('#filePic').val('');
                                $('.alert').addClass('show');

                                 //scroll to alert boostrap
                                 $('html, body').animate({
                                    scrollTop:$('.alert').offset().top
                                },2000);

                                var blink = setInterval(function() {
                                    $('.alert').fadeOut(100).fadeIn(500);
                                }, 600); // 1000 is the delay in milliseconds

                                setTimeout(function() {
                                    clearInterval(blink);
                                }, 4000); //                               
                               
                                return;
                            }
                            
                            var reader = new FileReader();                            

                            reader.onload = function(event){
                                // console.log(event.target.result,"event.target.result");
                                var file = event.target;
                                $('<div class="image-area" id="1"><img src="'+event.target.result+'" style="width: 100px;height: 100px;margin:5px;"><a class="remove-image" data-values="'+i+'" style="display: inline; color:red;">&#215;</a></div>').appendTo(placeToInsertImagePreview);                                                                
                            }                                                 
                            reader.readAsDataURL(f);
                        }
                    }


                };    
                
                $('.image-gallery').on('click','.remove-image',function(){
                    $cek_id = $(this).parent(".image-area").attr('id'); 
                    
                    if($cek_id != undefined)
                    {   //add remove_one id to every selected removed
                        $(this).parent(".image-area").attr('id','remove_one'); 
                        
                        //get all id with class image-area as array
                        var ids = $('.image-area').map(function() {
                            return $(this).attr('id');
                        });
                        datax = ids.toArray();
                        
                        //get every index with id remove_one
                        var results = [];
                        for ( i=0; i < datax.length; i++ ){
                            if ( datax[i] == 'remove_one' ){
                                results.push( i );
                            }
                        }
                        
                        //remove visual div
                        $(this).parent(".image-area").remove();      
                                             
                        //get fileList input img                
                        var files_pic = document.getElementById("filePic").files; 
                        
                        var fileBuffer = new DataTransfer();
                            // append the file list to an array iteratively
                        for (let i = 0; i <files_pic.length; i++) {
                            // Exclude file in specified index                            
                            if (!results.includes(i)){                                                                
                                //console.log(files_pic[i]);                                
                                    fileBuffer.items.add(files_pic[i]);
                            }
                        }

                        //reset array for next remove
                        datax = [];
                        results = [];
    
                        // Assign buffer to file input
                        temp_files = fileBuffer.files
                        document.getElementById("filePic").files = fileBuffer.files; // <-- according to your file input reference                        
                    }
                    else{
                        $(this).parent(".image-area").remove();
                    }
                    
                    var removed_img = $(this).attr("data-values");

                    removed_img_list.push(removed_img);
                    $("#img_removed").val(removed_img_list.toString());
                    
                });

                $('#filePicButton').on('click', function() {
                    //put old files in global var to prevent reset(prevent old pic remove from fileList)
                    old_pic = document.getElementById("filePic").files; 
                   
                });

                $('#filePic').on('change', function() {                    
                    imagepreview(this, 'div.image-gallery');   
                    //get new input img in fileLIst               
                    var files_pic_two = document.getElementById("filePic").files; 
                    //combined old list and new in 'joined' array
                    const joined = Array.from(old_pic).concat(Array.from(files_pic_two));                    
                    
                    console.log(joined);
                    // put in new fileList using DataTransfer()
                    var fileBuffer2 = new DataTransfer();
                    // append the file list to an array iteratively
                    for (let i = 0; i <joined.length; i++) {
                        fileBuffer2.items.add(joined[i]);
                    }
            
                    //input into 'input files' by ID
                    document.getElementById("filePic").files = fileBuffer2.files;
                });                                            
            });                                   
        


        });
        
        document.addEventListener('DOMContentLoaded', function () {
            const stepMenus = document.querySelectorAll('.formbold-steps ul li');
            const formSteps = document.querySelectorAll('[class^="formbold-form-step-"]');

            stepMenus.forEach((menu, index) => {
                menu.addEventListener('click', () => {
                    // Remove 'active' from all steps
                    stepMenus.forEach(m => m.classList.remove('active'));
                    formSteps.forEach(f => f.classList.remove('active'));

                    // Add 'active' to the clicked step and corresponding form step
                    menu.classList.add('active');
                    const formStep = document.querySelector(`.formbold-form-step-${index + 1}`);
                    if (formStep) {
                        formStep.classList.add('active');
                    }
                });
            });
        });  

        const tribeList = [
          "Jawa", "Sunda", "Batak", "Minangkabau", "Bugis", "Madura", "Aceh", "Betawi", "Dayak", "Bali",
          "Sasak", "Makassar", "Toraja", "Ambon", "Papua", "Asmat", "Tidore", "Ternate", "Nias", "Manado"
        ];

        let validTribe = ""; // menyimpan suku yang dipilih valid

        function showTopTribes() {
          const topTribes = tribeList.slice(0, 10);
          showSuggestions(topTribes);
        }

        function filterTribes(value) {
          const input = value.trim().toLowerCase();
          validTribe = ""; // reset valid state
          if (input.length < 3) {
            showTopTribes();
            return;
          }

          const matches = tribeList.filter(tribe => tribe.toLowerCase().startsWith(input));
          showSuggestions(matches);
        }

        function showSuggestions(list) {
          const suggestionBox = document.getElementById("tribe-suggestions");
          suggestionBox.innerHTML = "";

          if (list.length === 0) {
            suggestionBox.style.display = "none";
            return;
          }

          list.forEach(match => {
            const li = document.createElement("li");
            li.textContent = match;
            li.style.padding = "8px";
            li.style.cursor = "pointer";
            li.onmouseover = () => li.style.background = "#eee";
            li.onmouseout  = () => li.style.background = "#fff";
            li.onclick = () => {
              document.getElementById("tribe").value = match;
              validTribe = match;
              suggestionBox.style.display = "none";
            };
            suggestionBox.appendChild(li);
          });

          suggestionBox.style.display = "block";
        }

        // cek validasi saat form disubmit
        document.querySelector("form").addEventListener("submit", function(e) {
          const inputValue = document.getElementById("tribe").value;
          if (inputValue !== validTribe) {
            // alert("Please select a tribe from the list.");
            // e.preventDefault(); // hentikan submit
          }
        });

        // sembunyikan dropdown kalau klik di luar
        document.addEventListener("click", function(event) {
          const box = document.getElementById("tribe-suggestions");
          if (!document.getElementById("tribe").contains(event.target)) {
            box.style.display = "none";
          }
        });   

        const cityList_str = '{{city_list | tojson }}'
        const cityList = JSON.parse(cityList_str);                

        let validCity = ""; // menyimpan pilihan kota valid

        function showTopCities() {
          const topCities = cityList.slice(0, 10);
          showCitySuggestions(topCities);
        }

        function filterCities(value) {
          const input = value.trim().toLowerCase();
          validCity = ""; // reset valid state
          if (input.length < 3) {
            showTopCities();
            return;
          }

          const matches = cityList.filter(city => city.toLowerCase().startsWith(input));
          showCitySuggestions(matches);
        }

        function showCitySuggestions(list) {
          const suggestionBox = document.getElementById("city-suggestions");
          suggestionBox.innerHTML = "";

          if (list.length === 0) {
            suggestionBox.style.display = "none";
            return;
          }

          list.forEach(match => {
            const li = document.createElement("li");
            li.textContent = match;
            li.style.padding = "8px";
            li.style.cursor = "pointer";
            li.onmouseover = () => li.style.background = "#eee";
            li.onmouseout  = () => li.style.background = "#fff";
            li.onclick = () => {
              document.getElementById("city").value = match;
              validCity = match;
              suggestionBox.style.display = "none";
            };
            suggestionBox.appendChild(li);
          });

          suggestionBox.style.display = "block";
        }

        // validasi submit
        document.querySelector("form").addEventListener("submit", function(e) {
          const inputVal = document.getElementById("city").value;
          if (inputVal !== validCity) {
            alert("Please select a city from the list.");
            e.preventDefault();
          }
        });

        // klik di luar sembunyikan
        document.addEventListener("click", function(event) {
          const box = document.getElementById("city-suggestions");
          if (!document.getElementById("city").contains(event.target)) {
            box.style.display = "none";
          }
        }); 

         
    
  </script>
  </body>
  {% endautoescape %}
  
  </html>